# 你为什么想要扩展PHP？

想要扩展PHP通常有四个原因。到目前为止，最常见的原因是链接到外部库，并将其API提供给PHP语言使用。在像MySQL这样的扩展中我们可以看到这样的动机，这些扩展与libmysqlclient库链接，以向PHP脚本提供mysql_*()系列函数。

这些类型的扩展正是开发人员将PHP形容为“胶水”的原因。扩展代码本身并不直接进行工作处理，而是搭建了PHP扩展接口和库API接口之间的桥梁。如果缺少了它，向libmysqlclient这样的库和PHP之间就没有办法在一个共同层级进行通信了。

> 原文在这里展示了胶水扩展的一张图，因为比较简单（左边是PHP内核，右边是MySQL客户端库，中间就是PHP的MySQL扩展粘合两边），就不贴图了

扩展PHP的另一个原因是需要执行特殊的内部操作，如声明超级全局变量，由于安全限制或设计限制，无法在PHP语言层面完成。例如Advanced PHP Debugger(高级PHP调试器)和运行工具包执行的通常不可见的“仅内部”的虚拟机堆栈信息。

第三个原因是纯粹的速度需求。必须在虚拟机环境中对PHP代码进行标记化(token)，编译(compile)和逐步处理，而这些环境永远不会像机器码一样快。某些实现（字节码缓存）可以语言允许脚本在重复执行时跳过标记化和编译步骤，但是它们永远不能加快执行步骤。通过将其转换为C大妈，维护者牺牲一些设计中的易用性来使PHP变得更强大，提升几倍的性能。

> 这类Opcode的缓存扩展有
>
> * Opcache
> * eAccelerator
> * xcache
> * APC

最后的原因是，一个作者在不想透露源码的情况下，出售自己的程序。一种方式是使用操作码加密程序；但是这种方法比机器码扩展更容易破解。毕竟，为了对许可方有用，他们的PHP构建必须在某些时候才能访问编译的字节码。 在解密的字节码在内存中之后，将其提取到磁盘并显示代码是很容易的事情。事实上，字节码比原生二进制文件更容易解析获得源脚本。更尴尬的是，由于多了解密阶段，这种方式反而会更慢。