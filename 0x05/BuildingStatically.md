# 静态构建

在加载的模块列表中，你可能已经注意到列出了几个模块，这些模块在php.ini中没有使用扩展指令。这些模块直接构建到PHP中，并作为主构建过程的一部分进行编译。

## 在*nix下静态构建

在这一点上，如果你尝试将几个目录导航到PHP源代码树根目录，则可以运行./configurehelp并查看虽然示例扩展与其他所有模块一起位于ext/目录中，但它并未列为一个选项。这是因为，在生成./configure脚本时，你的扩展名是未知的。要重新生成./configure并让它找到你的新扩展，你只需要发出一个命令：

```shell
$ ./buildconf
```

> **注意**
>
> 如果你使用PHP的生产版本进行开发，你会发现./buildconf本身并不实际工作。在这种情况下，你需要发出：./buildconf强制绕过./configure命令内置的一些次要保护。

现在你可以发出./configure帮助，看看enable-sample是一个可用的选项。从这里，你可以重新发布./configure，包含你在主PHP构建中使用的所有选项，以及enable-sample，以创建一个包含完整的PHP解释器和自定义扩展的单个即时可用的二进制文件。

当然，这样做可能有点早。除了占用空间外，你的扩展还需要做些什么。现在我们坚持建立一个漂亮的精益共享对象。

## 在Windows下静态构建

重新生成Windows的configure.js脚本遵循与重新生成*nix的configure脚本相同的模式。导航到PHP源代码树的根目录，并像第4章那样重新发布buildconf.bat。

PHP构建系统将扫描config.w32文件，包括你刚刚为ext/sample创建的文件，并生成一个新的configure.js脚本，用它来构建一个静态的php二进制文件。